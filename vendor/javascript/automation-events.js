// automation-events@7.1.4 downloaded from https://ga.jspm.io/npm:automation-events@7.1.4/build/es5/bundle.js

import*as t from"@babel/runtime/helpers/slicedToArray";import*as e from"@babel/runtime/helpers/classCallCheck";import*as a from"@babel/runtime/helpers/createClass";var n=t;try{"default"in t&&(n=t.default)}catch(t){}var i=e;try{"default"in e&&(i=e.default)}catch(t){}var u=a;try{"default"in a&&(u=a.default)}catch(t){}var r=typeof globalThis!=="undefined"?globalThis:typeof self!=="undefined"?self:global;var o={};(function(t,e){e(o,n,i,u)})(0,(function(t,e,a,n){var i=function createExtendedExponentialRampToValueAutomationEvent(t,e,a){return{endTime:e,insertTime:a,type:"exponentialRampToValue",value:t}};var u=function createExtendedLinearRampToValueAutomationEvent(t,e,a){return{endTime:e,insertTime:a,type:"linearRampToValue",value:t}};var o=function createSetValueAutomationEvent(t,e){return{startTime:e,type:"setValue",value:t}};var v=function createSetValueCurveAutomationEvent(t,e,a){return{duration:a,startTime:e,type:"setValueCurve",values:t}};var l=function getTargetValueAtTime(t,e,a){var n=a.startTime,i=a.target,u=a.timeConstant;return i+(e-i)*Math.exp((n-t)/u)};var s=function isExponentialRampToValueAutomationEvent(t){return t.type==="exponentialRampToValue"};var m=function isLinearRampToValueAutomationEvent(t){return t.type==="linearRampToValue"};var c=function isAnyRampToValueAutomationEvent(t){return s(t)||m(t)};var d=function isSetValueAutomationEvent(t){return t.type==="setValue"};var f=function isSetValueCurveAutomationEvent(t){return t.type==="setValueCurve"};var h=function getValueOfAutomationEventAtIndexAtTime(t,e,a,n){var i=t[e];return i===void 0?n:c(i)||d(i)?i.value:f(i)?i.values[i.values.length-1]:l(a,h(t,e-1,i.startTime,n),i)};var E=function getEndTimeAndValueOfPreviousAutomationEvent(t,e,a,n,i){return a===void 0?[n.insertTime,i]:c(a)?[a.endTime,a.value]:d(a)?[a.startTime,a.value]:f(a)?[a.startTime+a.duration,a.values[a.values.length-1]]:[a.startTime,h(t,e-1,a.startTime,i)]};var T=function isCancelAndHoldAutomationEvent(t){return t.type==="cancelAndHold"};var p=function isCancelScheduledValuesAutomationEvent(t){return t.type==="cancelScheduledValues"};var V=function getEventTime(t){return T(t)||p(t)?t.cancelTime:s(t)||m(t)?t.endTime:t.startTime};var A=function getExponentialRampValueAtTime(t,e,a,n){var i=n.endTime,u=n.value;return a===u?u:0<a&&0<u||a<0&&u<0?a*Math.pow(u/a,(t-e)/(i-e)):0};var _=function getLinearRampValueAtTime(t,e,a,n){var i=n.endTime,u=n.value;return a+(t-e)/(i-e)*(u-a)};var g=function interpolateValue(t,e){var a=Math.floor(e);var n=Math.ceil(e);return a===n?t[a]:(1-(e-a))*t[a]+(1-(n-e))*t[n]};var y=function getValueCurveValueAtTime(t,e){var a=e.duration,n=e.startTime,i=e.values;var u=(t-n)/a*(i.length-1);return g(i,u)};var C=function isSetTargetAutomationEvent(t){return t.type==="setTarget"};var S=function(){function AutomationEventList(t){a(this||r,AutomationEventList);(this||r)._automationEvents=[];(this||r)._currenTime=0;(this||r)._defaultValue=t}return n(AutomationEventList,[{key:Symbol.iterator,value:function value(){return(this||r)._automationEvents[Symbol.iterator]()}},{key:"add",value:function add(t){var e=V(t);if(T(t)||p(t)){var a=(this||r)._automationEvents.findIndex((function(a){return p(t)&&f(a)?a.startTime+a.duration>=e:V(a)>=e}));var n=(this||r)._automationEvents[a];a!==-1&&((this||r)._automationEvents=(this||r)._automationEvents.slice(0,a));if(T(t)){var l=(this||r)._automationEvents[(this||r)._automationEvents.length-1];if(n!==void 0&&c(n)){if(l!==void 0&&C(l))throw new Error("The internal list is malformed.");var d=l===void 0?n.insertTime:f(l)?l.startTime+l.duration:V(l);var h=l===void 0?(this||r)._defaultValue:f(l)?l.values[l.values.length-1]:l.value;var E=s(n)?A(e,d,h,n):_(e,d,h,n);var g=s(n)?i(E,e,(this||r)._currenTime):u(E,e,(this||r)._currenTime);(this||r)._automationEvents.push(g)}l!==void 0&&C(l)&&(this||r)._automationEvents.push(o(this.getValue(e),e));if(l!==void 0&&f(l)&&l.startTime+l.duration>e){var y=e-l.startTime;var S=(l.values.length-1)/l.duration;var x=Math.max(2,1+Math.ceil(y*S));var R=y/(x-1)*S;var b=l.values.slice(0,x);if(R<1)for(var L=1;L<x;L+=1){var H=R*L%1;b[L]=l.values[L-1]*(1-H)+l.values[L]*H}(this||r)._automationEvents[(this||r)._automationEvents.length-1]=v(b,l.startTime,y)}}}else{var M=(this||r)._automationEvents.findIndex((function(t){return V(t)>e}));var k=M===-1?(this||r)._automationEvents[(this||r)._automationEvents.length-1]:(this||r)._automationEvents[M-1];if(k!==void 0&&f(k)&&V(k)+k.duration>e)return false;var I=s(t)?i(t.value,t.endTime,(this||r)._currenTime):m(t)?u(t.value,e,(this||r)._currenTime):t;if(M===-1)(this||r)._automationEvents.push(I);else{if(f(t)&&e+t.duration>V((this||r)._automationEvents[M]))return false;(this||r)._automationEvents.splice(M,0,I)}}return true}},{key:"flush",value:function flush(t){var e=(this||r)._automationEvents.findIndex((function(e){return V(e)>t}));if(e>1){var a=(this||r)._automationEvents.slice(e-1);var n=a[0];C(n)&&a.unshift(o(h((this||r)._automationEvents,e-2,n.startTime,(this||r)._defaultValue),n.startTime));(this||r)._automationEvents=a}}},{key:"getValue",value:function getValue(t){if((this||r)._automationEvents.length===0)return(this||r)._defaultValue;var a=(this||r)._automationEvents.findIndex((function(e){return V(e)>t}));var n=(this||r)._automationEvents[a];var i=(a===-1?(this||r)._automationEvents.length:a)-1;var u=(this||r)._automationEvents[i];if(u!==void 0&&C(u)&&(n===void 0||!c(n)||n.insertTime>t))return l(t,h((this||r)._automationEvents,i-1,u.startTime,(this||r)._defaultValue),u);if(u!==void 0&&d(u)&&(n===void 0||!c(n)))return u.value;if(u!==void 0&&f(u)&&(n===void 0||!c(n)||u.startTime+u.duration>t))return t<u.startTime+u.duration?y(t,u):u.values[u.values.length-1];if(u!==void 0&&c(u)&&(n===void 0||!c(n)))return u.value;if(n!==void 0&&s(n)){var o=E((this||r)._automationEvents,i,u,n,(this||r)._defaultValue),v=e(o,2),T=v[0],p=v[1];return A(t,T,p,n)}if(n!==void 0&&m(n)){var g=E((this||r)._automationEvents,i,u,n,(this||r)._defaultValue),S=e(g,2),x=S[0],R=S[1];return _(t,x,R,n)}return(this||r)._defaultValue}}])}();var x=function createCancelAndHoldAutomationEvent(t){return{cancelTime:t,type:"cancelAndHold"}};var R=function createCancelScheduledValuesAutomationEvent(t){return{cancelTime:t,type:"cancelScheduledValues"}};var b=function createExponentialRampToValueAutomationEvent(t,e){return{endTime:e,type:"exponentialRampToValue",value:t}};var L=function createLinearRampToValueAutomationEvent(t,e){return{endTime:e,type:"linearRampToValue",value:t}};var H=function createSetTargetAutomationEvent(t,e,a){return{startTime:e,target:t,timeConstant:a,type:"setTarget"}};t.AutomationEventList=S;t.createCancelAndHoldAutomationEvent=x;t.createCancelScheduledValuesAutomationEvent=R;t.createExponentialRampToValueAutomationEvent=b;t.createLinearRampToValueAutomationEvent=L;t.createSetTargetAutomationEvent=H;t.createSetValueAutomationEvent=o;t.createSetValueCurveAutomationEvent=v}));const v=o.AutomationEventList,l=o.createCancelAndHoldAutomationEvent,s=o.createCancelScheduledValuesAutomationEvent,m=o.createExponentialRampToValueAutomationEvent,c=o.createLinearRampToValueAutomationEvent,d=o.createSetTargetAutomationEvent,f=o.createSetValueAutomationEvent,h=o.createSetValueCurveAutomationEvent;export{v as AutomationEventList,l as createCancelAndHoldAutomationEvent,s as createCancelScheduledValuesAutomationEvent,m as createExponentialRampToValueAutomationEvent,c as createLinearRampToValueAutomationEvent,d as createSetTargetAutomationEvent,f as createSetValueAutomationEvent,h as createSetValueCurveAutomationEvent,o as default};

